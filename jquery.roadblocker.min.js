/* Roadblocker 1.4 */
!function(a){!function(a){if("function"==typeof define&&define.amd)define(a);else if("object"==typeof exports)module.exports=a();else{var b=window.Cookies,c=window.Cookies=a();c.noConflict=function(){return window.Cookies=b,c}}}(function(){function a(){for(var a=0,b={};a<arguments.length;a++){var c=arguments[a];for(var d in c)b[d]=c[d]}return b}function b(c){function d(b,e,f){var g;if("undefined"!=typeof document){if(arguments.length>1){if(f=a({path:"/"},d.defaults,f),"number"==typeof f.expires){var h=new Date;h.setMilliseconds(h.getMilliseconds()+864e5*f.expires),f.expires=h}try{g=JSON.stringify(e),/^[\{\[]/.test(g)&&(e=g)}catch(a){}return e=c.write?c.write(e,b):encodeURIComponent(String(e)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),b=encodeURIComponent(String(b)),b=b.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),b=b.replace(/[\(\)]/g,escape),document.cookie=[b,"=",e,f.expires?"; expires="+f.expires.toUTCString():"",f.path?"; path="+f.path:"",f.domain?"; domain="+f.domain:"",f.secure?"; secure":""].join("")}b||(g={});for(var i=document.cookie?document.cookie.split("; "):[],j=/(%[0-9A-Z]{2})+/g,k=0;k<i.length;k++){var l=i[k].split("="),m=l.slice(1).join("=");'"'===m.charAt(0)&&(m=m.slice(1,-1));try{var n=l[0].replace(j,decodeURIComponent);if(m=c.read?c.read(m,n):c(m,n)||m.replace(j,decodeURIComponent),this.json)try{m=JSON.parse(m)}catch(a){}if(b===n){g=m;break}b||(g[n]=m)}catch(a){}}return g}}return d.set=d,d.get=function(a){return d(a)},d.getJSON=function(){return d.apply({json:!0},[].slice.call(arguments))},d.defaults={},d.remove=function(b,c){d(b,"",a(c,{expires:-1}))},d.withConverter=b,d}return b(function(){})}),a.fn.roadblocker=function(b,c){var d=null,e=null;"string"==typeof b&&(e=b,b=null),"function"==typeof b&&(d=b,b=null);var f=a.extend({timesPerSession:1,totalTimesToShow:3,waitTime:1e4,ignorePaths:[],onlyPaths:[],onShow:d||function(){jQuery("body").addClass("roadblock-activated")},onClose:c||function(){jQuery("body").removeClass("roadblock-activated")},closeElement:null,log:!1},b);return this.each(function(){var c,g,b="roadblocker-permanent",d="roadblocker-session",h="timesDisplayed:",i="neverShow",j=0,k=0,l=Cookies.get(d);if(void 0!=l&&(g=l.replace(d+"=","").replace(/;.*/,""),j=g.match(/timesDisplayed:(\d*)/)[1],j=parseInt(j),!e&&j>=f.timesPerSession))return f.log&&console.log("Maximum times to show per session reached, exiting roadblocker..."),this;var m=Cookies.get(b);if(void 0!=m){if(c=m.replace(b+"=","").replace(/;.*/,""),!e&&m.includes(i))return f.log&&console.log("Permanent cookie has 'never show' flag set, exiting roadblocker..."),this;if(k=c.match(/timesDisplayed:(\d*)/)[1],k=parseInt(k),!e&&k>=f.totalTimesToShow)return f.log&&console.log("Maximum times to show over all time reached, exiting roadblocker..."),this}if(null!=e){if("close-once"==e||"close"==e)return a(this).data&&"function"==typeof a(this).data.onClose&&a(this).data.onClose(),this;if("close-permanently"==e)return Cookies.set(d,g+i),Cookies.set(b,c+i,{expires:3650}),a(this).data&&"function"==typeof a(this).data.onClose&&a(this).data.onClose(),this;"cancel"==e&&a(this).data("roadblocker-timer")&&(clearTimeout(a(this).data("roadblocker-timer")),console.log("Timeout cleared"),a(this).data("roadblocker-timer",null))}for(var n=location.pathname,o=0;o<f.ignorePaths.length;o++)if(f.ignorePaths[o]==n)return f.log&&(console.log(f),console.log("Path name matches a name in the ignorePaths list, exiting roadblocker...")),this;for(var o=0;o<f.onlyPaths.length;o++)if(f.onlyPaths[o]!=n)return f.log&&console.log("Path name does not match a name in the onlyPaths list, exiting roadblocker..."),this;void 0==l&&(l=Cookies.set(d,h+"0"),g=l.replace(d+"=","").replace(/;.*/,"")),void 0==m&&(m=Cookies.set(b,h+"0",{expires:3650}),c=m.replace(b+"=","").replace(/;.*/,"")),"function"==typeof f.onClose&&(a(this).data.onClose=f.onClose);var p=setTimeout(function(){j++,k++,Cookies.set(d,g.replace(/timesDisplayed:\d/,h+j)),Cookies.set(b,c.replace(/timesDisplayed:\d/,h+j),{expires:3650}),null!=f.onShow&&f.onShow()},f.waitTime);return a(this).data("roadblocker-timer",p),null!==f.closeElement&&jQuery("body").on("click",f.closeElement,function(){null!=f.onClose&&f.onClose()}),this})}}(jQuery);
